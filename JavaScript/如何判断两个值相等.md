ğŸ·: #ç›¸ç­‰

## ä¸€ã€åŸºç¡€ç±»å‹ç›¸ç­‰æ¯”è¾ƒ

`JavaScript`æä¾›ä¸‰ç§ä¸åŒå€¼çš„æ¯”è¾ƒæ“ä½œï¼š

### 1. éä¸¥æ ¼ç›¸ç­‰`==`

ç›¸ç­‰æ“ä½œç¬¦æ¯”è¾ƒä¸¤ä¸ªå€¼æ˜¯å¦ç›¸ç­‰ï¼Œåœ¨æ¯”è¾ƒå‰å°†ä¸¤ä¸ªè¢«æ¯”è¾ƒçš„å€¼è½¬æ¢ä¸ºç›¸åŒç±»å‹ã€‚åœ¨è½¬æ¢åï¼ˆç­‰å¼çš„ä¸€è¾¹æˆ–ä¸¤è¾¹éƒ½å¯èƒ½è¢«è½¬æ¢ï¼‰ï¼Œæœ€ç»ˆçš„æ¯”è¾ƒæ–¹å¼ç­‰åŒäºå…¨ç­‰æ“ä½œç¬¦ `===` çš„æ¯”è¾ƒæ–¹å¼ã€‚ ç›¸ç­‰æ“ä½œç¬¦æ»¡è¶³äº¤æ¢å¾‹ã€‚

```javascript
console.log([10] == 10); //true
console.log('10' == 10); //true
console.log([] == 0); //true
console.log(true == 1); //true
console.log([] == false); //true
console.log(![] == false); //true
console.log('' == 0); //true
console.log('' == false); //true
console.log(null == false); //false
console.log(!null == true); //true
console.log(null == undefined); //true

console.log(012 == 12); // false
console.log(012 == 10); // true
console.log(099 == 99); // true è¿™ç§æƒ…å†µæ˜¯å› ä¸ºå…«è¿›åˆ¶ä¸­ä¸å¯èƒ½å‡ºç°9ï¼Œæ‰€ä»¥çœ‹æˆä¸€ä¸ªåè¿›åˆ¶
console.log(09 == 9); // true åŒä¸Š
```

å®ƒçš„æ¯”è¾ƒè§„åˆ™å¦‚ä¸‹ï¼š


> -   å¦‚æœ Type(x)å’Œ Type(y)ç›¸åŒï¼Œè¿”å› x===y çš„ç»“æœ
> -   å¦‚æœ Type(x)å’Œ Type(y)ä¸åŒ
    -   å¦‚æœ x æ˜¯ nullï¼Œy æ˜¯ undefinedï¼Œè¿”å› true
    -   å¦‚æœ x æ˜¯ undefinedï¼Œy æ˜¯ nullï¼Œè¿”å› true
    -   å¦‚æœ Type(x)æ˜¯ Numberï¼ŒType(y)æ˜¯ Stringï¼Œè¿”å› x==ToNumber(y) çš„ç»“æœ
    -   å¦‚æœ Type(x)æ˜¯ Stringï¼ŒType(y)æ˜¯ Numberï¼Œè¿”å› ToNumber(x)==y çš„ç»“æœ
    -   å¦‚æœ Type(x)æ˜¯ Booleanï¼Œè¿”å› ToNumber(x)==y çš„ç»“æœ
    -   å¦‚æœ Type(y)æ˜¯ Booleanï¼Œè¿”å› x==ToNumber(y) çš„ç»“æœ
    -   å¦‚æœ Type(x)æ˜¯ String æˆ– Number æˆ– Symbol ä¸­çš„ä¸€ç§å¹¶ä¸” Type(y)æ˜¯ Objectï¼Œè¿”å› x==ToPrimitive(y) çš„ç»“æœ
    -   å¦‚æœ Type(x)æ˜¯ Object å¹¶ä¸” Type(y)æ˜¯ String æˆ– Number æˆ– Symbol ä¸­çš„ä¸€ç§ï¼Œè¿”å› ToPrimitive(x)==y çš„ç»“æœ
    -   å…¶ä»–è¿”å› false

### 2. ä¸¥æ ¼ç›¸ç­‰`===`

å…¨ç­‰æ“ä½œç¬¦æ¯”è¾ƒä¸¤ä¸ªå€¼æ˜¯å¦ç›¸ç­‰ï¼Œä¸¤ä¸ªè¢«æ¯”è¾ƒçš„å€¼åœ¨æ¯”è¾ƒå‰éƒ½ä¸è¿›è¡Œéšå¼è½¬æ¢ã€‚å¦‚æœä¸¤ä¸ªè¢«æ¯”è¾ƒçš„å€¼å…·æœ‰ä¸åŒçš„ç±»å‹ï¼Œè¿™ä¸¤ä¸ªå€¼æ˜¯ä¸å…¨ç­‰çš„ã€‚å¦åˆ™ï¼Œå¦‚æœä¸¤ä¸ªè¢«æ¯”è¾ƒçš„å€¼ç±»å‹ç›¸åŒï¼Œå€¼ä¹Ÿç›¸åŒï¼Œå¹¶ä¸”éƒ½ä¸æ˜¯ number ç±»å‹æ—¶ï¼Œä¸¤ä¸ªå€¼å…¨ç­‰ã€‚æœ€åï¼Œå¦‚æœä¸¤ä¸ªå€¼éƒ½æ˜¯ number ç±»å‹ï¼Œå½“ä¸¤ä¸ªéƒ½ä¸æ˜¯ NaNï¼Œå¹¶ä¸”æ•°å€¼ç›¸åŒï¼Œæˆ–æ˜¯ä¸¤ä¸ªå€¼åˆ†åˆ«ä¸º +0 å’Œ -0 æ—¶ï¼Œä¸¤ä¸ªå€¼è¢«è®¤ä¸ºæ˜¯å…¨ç­‰çš„ã€‚

```javascript
+0 === -0; // true
NaN === NaN; // false
```

å®ƒçš„æ¯”è¾ƒè§„åˆ™å¦‚ä¸‹ï¼š

> -   å¦‚æœ Type(x)å’Œ Type(y)ä¸åŒï¼Œè¿”å› false
> -   å¦‚æœ Type(x)å’Œ Type(y)ç›¸åŒ
    -   å¦‚æœ Type(x)æ˜¯ Undefinedï¼Œè¿”å› true
    -   å¦‚æœ Type(x)æ˜¯ Nullï¼Œè¿”å› true
    -   å¦‚æœ Type(x)æ˜¯ Stringï¼Œå½“ä¸”ä»…å½“ x,y å­—ç¬¦åºåˆ—å®Œå…¨ç›¸åŒï¼ˆé•¿åº¦ç›¸åŒï¼Œæ¯ä¸ªä½ç½®ä¸Šçš„å­—ç¬¦ä¹Ÿç›¸åŒï¼‰æ—¶è¿”å› trueï¼Œå¦åˆ™è¿”å› false
    -   å¦‚æœ Type(x)æ˜¯ Booleanï¼Œå¦‚æœ x,y éƒ½æ˜¯ true æˆ– x,y éƒ½æ˜¯ false è¿”å› trueï¼Œå¦åˆ™è¿”å› false
    -   å¦‚æœ Type(x)æ˜¯ Symbolï¼Œå¦‚æœ x,y æ˜¯ç›¸åŒçš„ Symbol å€¼ï¼Œè¿”å› true,å¦åˆ™è¿”å› false
    -   å¦‚æœ Type(x)æ˜¯ Number ç±»å‹
        -   å¦‚æœ x æ˜¯ NaNï¼Œè¿”å› false
        -   å¦‚æœ y æ˜¯ NaNï¼Œè¿”å› false
        -   å¦‚æœ x çš„æ•°å­—å€¼å’Œ y ç›¸ç­‰ï¼Œè¿”å› true
        -   å¦‚æœ x æ˜¯+0ï¼Œy æ˜¯-0ï¼Œè¿”å› true
        -   å¦‚æœ x æ˜¯-0ï¼Œy æ˜¯+0ï¼Œè¿”å› true
        -   å…¶ä»–è¿”å› false

### 3. `Object.is()`

`Object`åœ¨ä¸¥æ ¼ç­‰äºçš„åŸºç¡€ä¸Šä¿®å¤äº†ä¸€äº›ç‰¹æ®Šæƒ…å†µä¸‹çš„å¤±è¯¯ï¼Œå…·ä½“æ¥è¯´å°±æ˜¯+0 å’Œ-0ï¼ŒNaN å’Œ NaNã€‚

```javascript
Object.is(0, -0); // false
Object.is(+0, -0); // false
Object.is(0, +0); // true
Object.is(-0, -0); // true
Object.is(NaN, 0 / 0); // true
Object.is(NaN, NaN); // true
```

## äºŒã€å¼•ç”¨æ•°æ®ç±»å‹ç›¸ç­‰æ¯”è¾ƒ

### 1. `JSON.stringify(obj)`

```javascript
JSON.stringify(obj) === JSON.stringify(otherObj);
```

è¿™ç§æ–¹æ³•ç®€å•ï¼Œä¸€è¡Œä»£ç å°±æå®šï¼Œä½†æ˜¯æœ‰ç¼ºç‚¹ï¼Œå¦‚ä¸‹ï¼š

-   å½“å¯¹è±¡é‡Œ`key`å€¼é¡ºåºä¸ä¸€æ ·æ—¶ï¼Œå°±ä¼šå‡ºé”™
-   ä¸€äº›ç‰¹æ®Šç±»å‹çš„å€¼ï¼Œæ¯”å¦‚`undefined`ï¼Œ`Date`ï¼Œ`RegExp`ç­‰ä¼šä¸¢å¤±æˆ–è€…å˜å½¢

### 2. é€’å½’

å®ç°æ€è·¯å¦‚ä¸‹ï¼š

1. å…ˆåˆ¤æ–­ä¸¤ä¸ªå¯¹è±¡çš„`key`å€¼çš„é•¿åº¦ã€‚è‹¥é•¿åº¦ä¸ç›¸ç­‰ï¼Œåˆ™ `return false`
2. éå†å¯¹è±¡`obj1`ï¼Œæ£€æŸ¥å¯¹è±¡`obj2`ä¸­æ˜¯å¦æœ‰å¯¹åº”çš„`key`å€¼ï¼Œ æ²¡æœ‰ï¼Œåˆ™`return false`
3. æ¯”è¾ƒä¸¤ä¸ªå¯¹è±¡ä¸­è¿™ä¸ª`key`å¯¹åº”çš„å€¼çš„ç±»å‹æ˜¯å¦ç›¸ç­‰ï¼Œä¸ç›¸ç­‰ï¼Œåˆ™`return false`
4. å¦‚æœå€¼çš„ç±»å‹æ˜¯`undefined`ã€`number`ã€`string`ã€`boolean`çš„ä¸€ç§ï¼Œç›´æ¥ä¸¤ä¸ªå€¼æ¯”è¾ƒï¼Œä¸åŒï¼Œåˆ™`return false`
5. å¦‚æœå€¼æ˜¯`null`ï¼Œé‚£ä¹ˆ æ¯”è¾ƒä¸¤ä¸ªå€¼æ˜¯å¦ç›¸ç­‰ã€‚ä¸ç­‰ï¼Œåˆ™`return false`
6. å¦‚æœå€¼æ˜¯å¯¹è±¡ï¼Œè°ƒç”¨è‡ªèº«
7. å¦‚æœå€¼æ˜¯æ•°ç»„ï¼Œå› ä¸ºæ•°ç»„é¡¹å¯èƒ½æ˜¯ä»»æ„ä¸€ç§æ•°æ®ç±»å‹çš„ï¼Œæ‰€ä»¥è¿˜æ˜¯å…ˆæ¯”è¾ƒé•¿åº¦ï¼Œé•¿åº¦ç›¸ç­‰åå†é€ä¸€æ¯”è¾ƒæ•°ç»„çš„æ¯ä¸€é¡¹ã€‚

æ­¤ä»£ç åŒ…å«äº†å¦‚ä½•æ¯”è¾ƒä¸¤ä¸ªå¯¹è±¡ç›¸ç­‰ ï¼Œä»£ç å¦‚ä¸‹ï¼š

<iframe height="800" style="width: 100%;" scrolling="no" title="Untitled" src="https://codepen.io/aaaaaandy/embed/YzaRMpL?default-tab=html%2Cresult&editable=true" frameborder="no" loading="lazy" allowtransparency="true" allowfullscreen="true">
  See the Pen <a href="https://codepen.io/aaaaaandy/pen/YzaRMpL">
  Untitled</a> by aaaaaAndy (<a href="https://codepen.io/aaaaaandy">@aaaaaandy</a>)
  on <a href="https://codepen.io">CodePen</a>.
</iframe>

```javascript
const NUMBER_TAG = '[object Number]';
const STRING_TAG = '[object String]';
const BOOLEAN_TAG = '[object Boolean]';
const NULL_TAG = '[object Null]';
const UNDEFINED_TAG = '[object Undefined]';
const OBJECT_TAG = '[object Object]';
const ARRAY_TAG = '[object Array]';
const ERROR_TAG = '[object Error]';
const DATE_TAG = '[object Date]';
const REGEXP_TAG = '[object RegExp]';
const MAP_TAG = '[object Map]';
const SET_TAG = '[object Set]';

// ä»¥ä¸‹ä¸¤ç§ç±»å‹ä¸€èˆ¬ä¸æ¯”è¾ƒç›¸ç­‰æ€§
const SYMBOL_TAG = '[object Symbol]';
const FUNCTION_TAG = '[object Function]';

const toString = Object.prototype.toString;
const getKeys = Object.keys;

// mapè½¬æ•°ç»„
function mapToArray(map) {
	let idx = -1;
	const result = new Array(map.size);

	map.forEach(function (value, key) {
		result[++idx] = [key, value];
	});

	return result;
}

// setè½¬æ•°ç»„
function setToArray(set) {
	let idx = -1;
	const result = new Array(set.size);

	set.forEach(function (value) {
		result[++idx] = value;
	});

	return result;
}

/**
 * æ¯”è¾ƒä¸¤ä¸ªå˜é‡æ˜¯å¦ç›¸ç­‰ï¼ŒåŒ…æ‹¬å¼•ç”¨ç±»å‹
 * @param  {[type]} value  [description]
 * @param  {[type]} other  [description]
 * @param  {[type]} vStack [description]
 * @param  {[type]} oStack [description]
 * @return {[type]}        [description]
 */
function eq(value, other, vStack, oStack) {
	const valueType = toString.call(value);
	const otherType = toString.call(other);

	// ç±»å‹ä¸åŒç›´æ¥è¿”å›false
	if (valueType !== otherType) {
		return false;
	}

	// è¿™é‡Œç›´æ¥è¿›è¡Œä¸€ä¸ªç®€å•ç²—æš´çš„åˆ¤æ–­, è¿™é‡Œé»˜è®¤+0ä¸-0ç›¸ç­‰ï¼Œä¸å†è¿›è¡Œå¤„ç†
	// åŒæ ·é€‚ç”¨äºåŸºæœ¬ç±»å‹å’Œå¼•ç”¨ç±»å‹ï¼Œå¦‚æœæ˜¯åŒä¸€ä¸ªå¼•ç”¨ä¹Ÿå¯è¿”å›true
	if (value === other) {
		return true;
	}

	// å¤„ç†NaNä¸ç›¸ç­‰æƒ…å†µ
	if (value !== value && other !== other) {
		return true;
	}

	// å¤„ç†å…¶ä»–æƒ…å†µ
	switch (valueType) {
		case NUMBER_TAG:
		case DATE_TAG:
		case BOOLEAN_TAG:
			return +value === +other;
		case STRING_TAG:
		case REGEXP_TAG:
		case NULL_TAG:
		case UNDEFINED_TAG:
			return '' + value === '' + other;
		case ERROR_TAG:
			return value.name === other.name && value.message === other.message;
		case MAP_TAG:
			const valueMapArr = mapToArray(value);
			const otherMapArr = mapToArray(other);

			if (!eq(valueMapArr, otherMapArr, vStack, oStack)) {
				return false;
			}
			break;
		case SET_TAG:
			const valueSetArr = setToArray(value);
			const otherSetArr = setToArray(other);

			if (!eq(valueSetArr, otherSetArr, vStack, oStack)) {
				return false;
			}
			break;
		case ARRAY_TAG:
		case OBJECT_TAG:
			// é¦–å…ˆå¯¹æ¯”æ˜¯å¦ä¸ºå¾ªç¯å¼•ç”¨
			vStack = vStack || [];
			oStack = oStack || [];
			let vStackLength = vStack.length;

			while (vStackLength--) {
				if (
					vStack[vStackLength] === value &&
					oStack[vStackLength] === other
				) {
					return true;
				}
			}

			vStack.push(value);
			oStack.push(other);

			// æ•°ç»„å¯¹æ¯”
			if (valueType === ARRAY_TAG) {
				let vLength = value.length;
				let oLength = other.length;

				if (vLength !== oLength) {
					return false;
				}

				while (vLength--) {
					if (!eq(value[vLength], other[vLength], vStack, oStack)) {
						return false;
					}
				}
			}

			// å¯¹è±¡å¯¹æ¯”
			if (valueType === OBJECT_TAG) {
				const vKeys = getKeys(value);
				const oKeys = getKeys(other);
				let vKeysLength = vKeys.length;

				if (vKeys.length !== oKeys.length) {
					return false;
				}

				while (vKeysLength--) {
					// å¯¹è±¡çš„keyé¡ºåºå¯èƒ½ä¸ä¸€æ ·ï¼Œä½†æ˜¯å¯¹è±¡ä»ç„¶å¯èƒ½ç›¸ç­‰
					if (!oKeys.includes(vKeys[vKeysLength])) {
						return false;
					}

					let currentKey = vKeys[vKeysLength];
					if (
						!eq(
							value[currentKey],
							other[currentKey],
							vStack,
							oStack
						)
					) {
						return false;
					}
				}
			}
			break;
		default:
			return String(value) === String(other);
	}

	return true;
}
```
