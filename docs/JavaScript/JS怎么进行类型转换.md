ğŸ·: #JavaScript #ç±»å‹è½¬æ¢

## ä¸€ã€æ˜¾å¼/éšå¼ç±»å‹è½¬æ¢

> ç±»å‹è½¬æ¢å‘ç”Ÿåœ¨é™æ€ç±»å‹è¯­è¨€çš„ç¼–è¯‘é˜¶æ®µï¼Œè€Œå¼ºåˆ¶ç±»å‹è½¬æ¢åˆ™å‘ç”Ÿåœ¨åŠ¨æ€ç±»å‹è¯­è¨€çš„è¿è¡Œæ—¶(runtime)ã€‚ç„¶è€Œåœ¨ JavaScript ä¸­é€šå¸¸å°†å®ƒä»¬ç»Ÿç§°ä¸ºå¼ºåˆ¶ç±»å‹è½¬æ¢ã€‚

æˆ‘ä¸ªäººåˆ™å€¾å‘äºç”¨â€œéšå¼å¼ºåˆ¶ç±»å‹è½¬æ¢â€(implicit coercion)å’Œâ€œæ˜¾å¼å¼ºåˆ¶ç±»å‹è½¬æ¢â€(explicit coercion)æ¥åŒºåˆ†ï¼š

- æ˜¾å¼å¼ºåˆ¶ç±»å‹è½¬æ¢ï¼šæ‰‹åŠ¨åœ°å°†ä¸€ç§ç±»å‹çš„å€¼è½¬ä¸ºå¦ä¸€ç§ç±»å‹ï¼Œå¸¸è§çš„æ˜¾å¼è½¬æ¢æ–¹æ³•æœ‰ï¼š`Number`ã€`String`ã€`Boolean`ã€`parseInt`ã€`parseFloat`ã€`toString` ç­‰ç­‰ï¼›
- éšå¼å¼ºåˆ¶ç±»å‹è½¬æ¢ï¼šä¸€èˆ¬æ˜¯åœ¨æ¶‰åŠè¿ç®—ç¬¦çš„æ—¶å€™æ‰å‡ºç°çš„æƒ…å†µï¼Œæ¯”å¦‚ä¸¤ä¸ªä¸åŒç±»å‹çš„å˜é‡ç›¸åŠ å‡ã€å–åç­‰ã€‚

### 1. è½¬æ¢ä¸ºå­—ç¬¦ä¸²

#### 1.1 `toString()`

è¿™ç§æ–¹æ³•å¯ä»¥å°†`number`ã€`boolean`å’Œ`object`ç±»å‹è½¬æ¢ä¸º`string`ï¼Œä½†æ˜¯æ— æ³•è½¬æ¢`null`å’Œ`undefined`ã€‚

<!-- tabs:start -->

#### **é¢˜ç›®1**

çŒœçŒœä¸‹é¢å„é¡¹éƒ½ä¼šè½¬æ¢æˆä»€ä¹ˆå€¼ï¼Ÿ

```javascript
(1).toString()   
true.toString()    
({}).toString()
([]).toString()
([1, 2, 3]).toString()   
```

#### **ç­”æ¡ˆ1**

ç­”æ¡ˆå¦‚ä¸‹ï¼š

```javascript
(1).toString()       // '1'
true.toString()     // 'true'
({}).toString()     // '[object Object]'
([]).toString()     // ''
([1, 2, 3]).toString()   // â€˜1,2,3â€™
```

<!-- tabs:end -->

è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯`{}`è°ƒç”¨`toString()`æ˜¯è°ƒç”¨äº†åŸå‹é“¾é¡¶ç«¯çš„`toString()`æ–¹æ³•ï¼Œå®ƒè¿”å›`object`çš„`[[class]]`å±æ€§ï¼Œè€Œ`[]`è°ƒç”¨çš„`toString()`æ˜¯`Array`é‡å†™è¿‡ä¹‹åçš„æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•çš„åŠŸèƒ½æ˜¯å°†æ•°ç»„é‡Œçš„æ¯ä¸ªå€¼å–å‡ºæ‹¼æˆä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå¹¶ä¸”æ¯ä¸ªå€¼ä¹‹é—´ä»¥`,`éš”å¼€ï¼Œè¿™é‡Œå› ä¸ºæ˜¯ç©ºæ•°ç»„ï¼Œæ‰€ä»¥è¿”å›`â€˜â€™`ã€‚

#### 1.2 `String()`

`string()`æ˜¯ä¸€ä¸ªå…¨å±€å‡½æ•°ï¼ŒåŸºæœ¬ä¸Šèƒ½è½¬æ¢æ‰€æœ‰çš„æ•°æ®ç±»å‹ä¸º`string`ã€‚

<!-- tabs:start -->

#### **é¢˜ç›®2**

çŒœçŒœä¸‹é¢å„é¡¹éƒ½ä¼šè½¬æ¢æˆä»€ä¹ˆå€¼ï¼Ÿ

```javascript
String(123)
String('123')
String(true) 
String(false) 
String(undefined) 
String(null) 
String({a: 123}) 
String([1, 2, 3])
```

#### **ç­”æ¡ˆ2**

ç­”æ¡ˆå¦‚ä¸‹ï¼š

```javascript
String(123)         // '123'
String('123')       // '123'
String(true)        // 'true'
String(false)       // 'false'
String(undefined)   // 'undefined'
String(null)        // 'null'
String({a: 123})    // '[object Object]'
String([1, 2, 3])   // '1,2,3'
```

<!-- tabs:end -->

`String()`è½¬æ¢å¯¹è±¡æ—¶ä¸`toStirng()`é€»è¾‘ç›¸åŒã€‚

#### 1.3 æ“ä½œç¬¦ï¼š`+`

è¿™æ˜¯æœ€ç®€å•ä¾¿æ·çš„ä¸€ç§æ–¹å¼ï¼Œå°†å…¶ä»–ç±»å‹çš„å˜é‡åŠ ä¸Šä¸€ä¸ªç©ºå­—ç¬¦ä¸²éƒ½å¯ä»¥è½¬æˆä¸€ä¸ªå­—ç¬¦ä¸²ç±»å‹ã€‚

<!-- tabs:start -->

#### **é¢˜ç›®3**

çŒœçŒœä¸‹é¢å„é¡¹éƒ½ä¼šè½¬æ¢æˆä»€ä¹ˆå€¼ï¼Ÿ

```javascript
1 + ''    
null + ''   
undefined + ''
true + ''   
{} + ''
[] + '' 
[1, 2, 3] + ''  
```

#### **ç­”æ¡ˆ3**

ç­”æ¡ˆå¦‚ä¸‹ï¼š

```javascript
1 + ''            // "1"
null + ''         // "null"
undefined + ''    // "undefined"
true + ''         // "true"
{} + ''           // 0
[] + ''           // ""
[1, 2, 3] + ''    // "1,2,3"
```

<!-- tabs:end -->

### 2. è½¬æ¢ä¸ºæ•°å€¼ç±»å‹

#### 2.1 `Number()`

é™¤äº†è¦è½¬æ¢çš„ç±»å‹æœ¬æ¥å°±æ˜¯ç”±æ•°å­—ç»„æˆä¹‹å¤–ï¼Œå…¶ä»–çš„è½¬æ¢ä¸€å¾‹å˜æˆ`NaN`ã€‚

<!-- tabs:start -->

#### **é¢˜ç›®4**

çŒœçŒœä¸‹é¢å„é¡¹éƒ½ä¼šè½¬æ¢æˆä»€ä¹ˆå€¼ï¼Ÿ

```javascript
Number('1')  
Number('+1')  
Number('-1')   
Number('s')    
Number(null)  
Number(undefined)  
Number({})      
Number([])    
Number([1, 2, 3])  
Number([1]) 
```

#### **ç­”æ¡ˆ4**

ç­”æ¡ˆå¦‚ä¸‹ï¼š

```javascript
Number('1')         // 1
Number('+1')        // 1
Number('-1')        // -1
Number('s')         // NaN
Number(null)        // 0
Number(undefined)   // NaN
Number({})          // NaN
Number([])          // 0
Number([1, 2, 3])   // NaN
Number([1])         // 1
```

<!-- tabs:end -->

#### 2.2 `parseInt(x, 10)`

å°†å…¶ä»–ç±»å‹è½¬æ¢æˆæ•´æ•°ç±»å‹ï¼Œåé¢çš„10è¡¨ç¤ºçš„æ˜¯åè¿›åˆ¶ï¼Œå–å€¼èŒƒå›´åœ¨`2 ~ 37`ä¹‹é—´ã€‚ä¸€èˆ¬éƒ½æ˜¯è¿›åˆ¶ä¹‹é—´çš„è½¬æ¢ã€‚

<!-- tabs:start -->

#### **é¢˜ç›®5**

çŒœçŒœä¸‹é¢å„é¡¹éƒ½ä¼šè½¬æ¢æˆä»€ä¹ˆå€¼ï¼Ÿ

```javascript
parseInt('123')
parseInt('123abc')
parseInt('123.45')
parseInt('10', 2)
parseInt('011',10) 
parseInt('0x11',10)
parseInt('011',36) 
parseInt('0x11')   
parseInt('08')    
parseInt('011',2)
```

#### **ç­”æ¡ˆ5**

ç­”æ¡ˆå¦‚ä¸‹ï¼š

```javascript
parseInt('123')           // 123
parseInt('123abc')        // 123
parseInt('123.45')        // 123
parseInt('10', 2)         // 2
parseInt('011',10)        // 11
parseInt('0x11',10)       // 0
parseInt('011',36)        // 37
parseInt('0x11')          // 17
parseInt('08')            // 8
parseInt('011',2)         // 3
```

<!-- tabs:end -->



#### 2.3 `x - 0`

è¿™æ˜¯ä¸€ç§æœ€ç®€å•å¿«æ·çš„æ–¹å¼ï¼Œå­—ç¬¦ä¸²å‡å»ä¸€ä¸ª0å¯ä»¥è½¬æ¢æˆæ•°å­—ã€‚

åœ¨æ•°å­¦è¿ç®—ç¬¦ä¸­ï¼Œé™¤äº†`+`ï¼Œå…¶ä»–è¿ç®—ç¬¦éƒ½æœŸæœ›å¾—åˆ°æ•°å€¼è¿›è¡Œè¿ç®—ï¼Œå®ƒä»¬çš„è¡¨ç°ä¸`-`æ˜¯ç›¸åŒçš„ã€‚

<!-- tabs:start -->

#### **é¢˜ç›®6**

çŒœçŒœä¸‹é¢å„é¡¹éƒ½ä¼šè½¬æ¢æˆä»€ä¹ˆå€¼ï¼Ÿ

```javascript
'1' - 1  
1 - '1'  
'1' - '1'  
'1' - null  
1 - null    
null - '1'   
null - 1   
'1' - undefined 
'1' - {}    
{} - '1'   
'1' - []  
[] - '1'   
```

#### **ç­”æ¡ˆ6**

ç­”æ¡ˆå¦‚ä¸‹ï¼š

```javascript
'1' - 1           // 0
1 - '1'           // 0
'1' - '1'         // 0
'1' - null        // 1
1 - null          // 1
null - '1'        // -1
null - 1          // -1
'1' - undefined   // NaN
'1' - {}          // NaN
{} - '1'          // -1
'1' - []          // 1
[] - '1'          // -1
```

<!-- tabs:end -->


#### 2.4 `+x`

åœ¨è¦è½¬æ¢çš„ç±»å‹å‰é¢åŠ ä¸Š`+`å¯ä»¥è½¬æ¢æˆæ•°å­—ï¼Œå¹¶ä¸æ˜¯å–ç»å¯¹å€¼ã€‚

<!-- tabs:start -->

#### **é¢˜ç›®7**

çŒœçŒœä¸‹é¢å„é¡¹éƒ½ä¼šè½¬æ¢æˆä»€ä¹ˆå€¼ï¼Ÿ

```javascript
+'1'  
+'-1'   
+{}    
+[]  
```

#### **ç­”æ¡ˆ7**

ç­”æ¡ˆå¦‚ä¸‹ï¼š

```javascript
+'1'          // 1
+'-1'         // -1
+{}           // NaN
+[]           // 0
```

<!-- tabs:end -->

### 3. è½¬æ¢ä¸º`boolean`

#### 3.1 `Boolean()`

å¯ä»¥è½¬æ¢æ‰€æœ‰ç±»å‹çš„å€¼ä¸ºå¸ƒå°”ç±»å‹ã€‚

<!-- tabs:start -->

#### **é¢˜ç›®8**

çŒœçŒœä¸‹é¢å„é¡¹éƒ½ä¼šè½¬æ¢æˆä»€ä¹ˆå€¼ï¼Ÿ

```javascript
Boolean(1)     
Boolean(null)    
Boolean(undefined)  
Boolean({})   
Boolean([])   
Boolean('s')     
```

#### **ç­”æ¡ˆ8**

ç­”æ¡ˆå¦‚ä¸‹ï¼š

```javascript
Boolean(1)            // true
Boolean(null)         // false
Boolean(undefined)    // false
Boolean({})           // true
Boolean([])           // true
Boolean('s')          // true
```

<!-- tabs:end -->

#### 3.2 `!!`

è¿™æ˜¯ä¸€ç§æœ€å¿«æœ€ä¾¿æ·çš„æ–¹å¼å°†å…¶ä»–ç±»å‹çš„å€¼è½¬ä¸ºå¸ƒå°”ç±»å‹ã€‚

<!-- tabs:start -->

#### **é¢˜ç›®9**

çŒœçŒœä¸‹é¢å„é¡¹éƒ½ä¼šè½¬æ¢æˆä»€ä¹ˆå€¼ï¼Ÿ

```javascript
!!1     
!!null      
!!undefined  
!!obj   
!!'s'   
```

#### **ç­”æ¡ˆ9**

ç­”æ¡ˆå¦‚ä¸‹ï¼š

```javascript
!!1             // true
!!null          // false
!!undefined     // false
!!obj           // true
!!'s'           // true
```

<!-- tabs:end -->

## äºŒã€`{} + []`ä¸`[] + {}`çš„åŒºåˆ«

åœ¨`JavaScript`çš„è¿ç®—ç¬¦ä¸­ï¼Œ`+`æ˜¯å¾ˆé‡è¦çš„ä¸€ç§è¿ç®—ç¬¦ï¼Œä¸ç®¡æ˜¯æ•°ç»„çš„è¿ç®—è¿˜æ˜¯å­—ç¬¦ä¸²çš„æ‹¼æ¥ã€‚åœ¨äº†è§£æœ¬é¢˜ç›®ä¹‹å‰éœ€è¦å…ˆäº†è§£ä»¥ä¸‹ä¸¤ä¸ªé‡ç‚¹ï¼š

1. åŠ å·`+`è¿ç®—åœ¨`JavaScript`ä¸­ï¼Œä½¿ç”¨ä¸Šçš„è§„å®šæ˜¯ä»€ä¹ˆï¼› 
2. å¯¹è±¡åœ¨`JavaScript`æ˜¯æ€ä¹ˆè½¬æ¢ä¸ºåŸå§‹æ•°æ®ç±»å‹çš„ã€‚

### 1. åŠ å·è¿ç®—ç¬¦

åœ¨æ ‡å‡†ä¸­è½¬æ¢çš„è§„åˆ™è¿˜æœ‰ä»¥ä¸‹å‡ ä¸ªï¼Œè¦æ³¨æ„å®ƒçš„é¡ºåºï¼š

```javascript
operand + operand = result
```

1. ä½¿ç”¨`ToPrimitive`è¿ç®—è½¬æ¢å·¦ä¸å³è¿ç®—å…ƒä¸ºåŸå§‹æ•°æ®ç±»å‹å€¼(`primitive`)
2. åœ¨ç¬¬`1`æ­¥è½¬æ¢åï¼Œå¦‚æœæœ‰è¿ç®—å…ƒå‡ºç°åŸå§‹æ•°æ®ç±»å‹æ˜¯"å­—ç¬¦ä¸²"ç±»å‹å€¼æ—¶ï¼Œåˆ™å¦ä¸€è¿ç®—å…ƒä½œå¼ºåˆ¶è½¬æ¢ä¸ºå­—ç¬¦ä¸²ï¼Œç„¶åä½œå­—ç¬¦ä¸²çš„è¿æ¥è¿ç®—(`concatenation`)
3. åœ¨å…¶ä»–æƒ…å†µæ—¶ï¼Œæ‰€æœ‰è¿ç®—å…ƒéƒ½ä¼šè½¬æ¢ä¸ºåŸå§‹æ•°æ®ç±»å‹çš„"æ•°å­—"ç±»å‹å€¼ï¼Œç„¶åä½œæ•°å­¦çš„ç›¸åŠ è¿ç®—(`addition`)

### 2. ToPrimitive`å†…éƒ¨è¿ç®—

åŠ å·è¿ç®—ç¬¦åªèƒ½ä½¿ç”¨åŸå§‹æ•°æ®ç±»å‹ï¼Œé‚£ä¹ˆå¯¹äºå¯¹è±¡ç±»å‹çš„å€¼å°±éœ€è¦å…ˆè½¬æˆåŸå§‹æ•°æ®ç±»å‹ã€‚è¿™ç§æƒ…å†µä¸æ­¢ä¼šå‡ºç°åœ¨åŠ å·è¿ç®—ä¸­ï¼Œåœ¨å…³ç³»æ¯”è¾ƒæˆ–å€¼ç›¸ç­‰æ¯”è¾ƒçš„è¿ç®—ä¸­ä¹Ÿæ˜¯å¦‚æ­¤ã€‚

```javascript
ToPrimitive(input, PreferredType?)
```

`input`ä»£è¡¨ä»£å…¥çš„å€¼ï¼Œè€Œ`PreferredType`å¯ä»¥æ˜¯æ•°å­—(Number)æˆ–å­—ç¬¦ä¸²(String)å…¶ä¸­ä¸€ç§ï¼Œè¿™ä¼šä»£è¡¨"ä¼˜å…ˆçš„"ã€"é¦–é€‰çš„"çš„è¦è¿›è¡Œè½¬æ¢åˆ°å“ªä¸€ç§åŸå§‹ç±»å‹ï¼Œè½¬æ¢çš„æ­¥éª¤ä¼šä¾è¿™é‡Œçš„å€¼è€Œæœ‰æ‰€ä¸åŒã€‚ä½†å¦‚æœæ²¡æœ‰æä¾›è¿™ä¸ªå€¼ä¹Ÿå°±æ˜¯é¢„è®¾æƒ…å†µï¼Œåˆ™ä¼šè®¾ç½®è½¬æ¢çš„`hint`å€¼ä¸º`"default"`ã€‚è¿™ä¸ªé¦–é€‰çš„è½¬æ¢åŸå§‹ç±»å‹çš„æŒ‡ç¤º(`hint`å€¼)ï¼Œæ˜¯åœ¨ä½œå†…éƒ¨è½¬æ¢æ—¶ç”±JSè§†æƒ…å†µè‡ªåŠ¨åŠ ä¸Šçš„ï¼Œä¸€èˆ¬æƒ…å†µå°±æ˜¯é¢„è®¾å€¼ã€‚

è€Œåœ¨`JavaScript`çš„`Object`åŸå‹çš„è®¾è®¡ä¸­ï¼Œéƒ½ä¸€å®šä¼šæœ‰ä¸¤ä¸ª`valueOf`ä¸`toString`æ–¹æ³•ï¼Œæ‰€ä»¥è¿™ä¸¤ä¸ªæ–¹æ³•åœ¨æ‰€æœ‰å¯¹è±¡é‡Œé¢éƒ½ä¼šæœ‰ï¼Œä¸è¿‡å®ƒä»¬åœ¨è½¬æ¢æœ‰å¯èƒ½ä¼šäº¤æ¢è¢«è°ƒç”¨çš„é¡ºåºã€‚

#### 2.1 å½“`PreferredType`ä¸ºæ•°å­—`(Number)`æ—¶

å½“`PreferredType`ä¸ºæ•°å­—(Number)æ—¶ï¼Œ`input`ä¸ºè¦è¢«è½¬æ¢çš„å€¼ï¼Œä»¥ä¸‹æ˜¯è½¬æ¢è¿™ä¸ª`input`å€¼çš„æ­¥éª¤:

1.  å¦‚æœ`input`æ˜¯åŸå§‹æ•°æ®ç±»å‹ï¼Œåˆ™ç›´æ¥è¿”å›`input`ã€‚
2.  å¦åˆ™ï¼Œå¦‚æœ`input`æ˜¯ä¸ªå¯¹è±¡æ—¶ï¼Œåˆ™è°ƒç”¨å¯¹è±¡çš„`valueOf()`æ–¹æ³•ï¼Œå¦‚æœèƒ½å¾—åˆ°åŸå§‹æ•°æ®ç±»å‹çš„å€¼ï¼Œåˆ™è¿”å›è¿™ä¸ªå€¼ã€‚
3.  å¦åˆ™ï¼Œå¦‚æœ`input`æ˜¯ä¸ªå¯¹è±¡æ—¶ï¼Œè°ƒç”¨å¯¹è±¡çš„`toString()`æ–¹æ³•ï¼Œå¦‚æœèƒ½å¾—åˆ°åŸå§‹æ•°æ®ç±»å‹çš„å€¼ï¼Œåˆ™è¿”å›è¿™ä¸ªå€¼ã€‚
4.  å¦åˆ™ï¼ŒæŠ›å‡ºTypeErroré”™è¯¯ã€‚

#### 2.2 å½“`PreferredType`ä¸ºå­—ç¬¦ä¸²`(String)`æ—¶

ä¸Šé¢çš„æ­¥éª¤2ä¸3å¯¹è°ƒï¼Œå¦‚åŒä¸‹é¢æ‰€è¯´:

1.  å¦‚æœ`input`æ˜¯åŸå§‹æ•°æ®ç±»å‹ï¼Œåˆ™ç›´æ¥è¿”å›`input`ã€‚
2.  å¦åˆ™ï¼Œå¦‚æœ`input`æ˜¯ä¸ªå¯¹è±¡æ—¶ï¼Œè°ƒç”¨å¯¹è±¡çš„`toString()`æ–¹æ³•ï¼Œå¦‚æœèƒ½å¾—åˆ°åŸå§‹æ•°æ®ç±»å‹çš„å€¼ï¼Œåˆ™è¿”å›è¿™ä¸ªå€¼ã€‚
3.  å¦åˆ™ï¼Œå¦‚æœ`input`æ˜¯ä¸ªå¯¹è±¡æ—¶ï¼Œåˆ™è°ƒç”¨å¯¹è±¡çš„`valueOf()`æ–¹æ³•ï¼Œå¦‚æœèƒ½å¾—åˆ°åŸå§‹æ•°æ®ç±»å‹çš„å€¼ï¼Œåˆ™è¿”å›è¿™ä¸ªå€¼ã€‚
4.  å¦åˆ™ï¼ŒæŠ›å‡ºTypeErroré”™è¯¯ã€‚

#### 2.3 `PreferredType`æ²¡æä¾›æ—¶ï¼Œä¹Ÿå°±æ˜¯`hint`ä¸º`"default"`æ—¶

ä¸`PreferredType`ä¸ºæ•°å­—`(Number)`æ—¶çš„æ­¥éª¤ç›¸åŒã€‚**æ•°å­—**å…¶å®æ˜¯é¢„è®¾çš„é¦–é€‰ç±»å‹ï¼Œä¹Ÿå°±æ˜¯è¯´åœ¨ä¸€èˆ¬æƒ…å†µä¸‹ï¼ŒåŠ å·è¿ç®—ä¸­çš„å¯¹è±¡è¦ä½œè½¬å‹æ—¶ï¼Œéƒ½æ˜¯å…ˆè°ƒç”¨`valueOf`å†è°ƒç”¨`toString`ã€‚

ä½†è¿™æœ‰ä¸¤ä¸ªå¼‚å¸¸ï¼Œä¸€ä¸ªæ˜¯`Date`å¯¹è±¡ï¼Œå¦ä¸€æ˜¯`Symbol`å¯¹è±¡ï¼Œå®ƒä»¬è¦†ç›–äº†åŸæ¥çš„`PreferredType`è¡Œä¸ºï¼Œ`Date`å¯¹è±¡çš„é¢„è®¾é¦–é€‰ç±»å‹æ˜¯å­—ç¬¦ä¸²`(String)`ã€‚å› æ­¤ä½ ä¼šçœ‹åˆ°åœ¨ä¸€äº›æ•™ç¨‹æ–‡ä»¶ä¸Šä¼šåŒºåˆ†ä¸ºä¸¤å¤§ç±»å¯¹è±¡ï¼Œä¸€ç±»æ˜¯ `Date` å¯¹è±¡ï¼Œå¦ä¸€ç±»å« é`Date(non-date)` å¯¹è±¡ã€‚å› ä¸ºè¿™ä¸¤å¤§ç±»çš„å¯¹è±¡åœ¨è¿›è¡Œè½¬æ¢ä¸ºåŸå§‹æ•°æ®ç±»å‹æ—¶ï¼Œé¦–é€‰ç±»å‹æ°å¥½ç›¸åã€‚

### 3. `valueOf`ä¸`toString`æ–¹æ³•

åœ¨JSä¸­æ‰€è®¾è®¡çš„`Object`çº¯å¯¹è±¡ç±»å‹çš„`valueOf`ä¸`toString`æ–¹æ³•ï¼Œå®ƒä»¬çš„è¿”å›å¦‚ä¸‹:

-   `valueOf`æ–¹æ³•è¿”å›å€¼: å¯¹è±¡æœ¬èº«ã€‚
-   `toString`æ–¹æ³•è¿”å›å€¼:` "[object Object]"`å­—ç¬¦ä¸²å€¼ï¼Œä¸åŒçš„å†…å»ºå¯¹è±¡çš„è¿”å›å€¼æ˜¯`"[object type]"`å­—ç¬¦ä¸²ï¼Œ`"type"`

æŒ‡çš„æ˜¯å¯¹è±¡æœ¬èº«çš„ç±»å‹è¯†åˆ«ï¼Œä¾‹å¦‚`Math`å¯¹è±¡æ˜¯è¿”å›`"[object Math]"`å­—ç¬¦ä¸²ã€‚ä½†æœ‰äº›å†…å»ºå¯¹è±¡å› ä¸ºè¦†ç›–äº†è¿™ä¸ªæ–¹æ³•ï¼Œæ‰€ä»¥ç›´æ¥è°ƒç”¨æ—¶ä¸æ˜¯è¿™ç§å€¼ã€‚(æ³¨æ„: è¿™ä¸ªè¿”å›å­—ç¬¦ä¸²çš„å‰é¢çš„`"object"`å¼€å¤´è‹±æ–‡æ˜¯å°å†™ï¼Œåé¢å¼€å¤´è‹±æ–‡æ˜¯å¤§å†™)

â€‹	ä½ æœ‰å¯èƒ½ä¼šçœ‹è¿‡ï¼Œåˆ©ç”¨`Object`ä¸­çš„`toString`æ¥è¿›è¡Œå„ç§ä¸åŒå¯¹è±¡çš„åˆ¤æ–­è¯­æ³•ï¼Œè¿™åœ¨ä»¥å‰JSèƒ½ç”¨çš„å‡½æ•°åº“æˆ–æ–¹æ³•ä¸å¤šçš„å¹´ä»£ç»å¸¸çœ‹åˆ°ï¼Œä¸è¿‡å®ƒéœ€è¦é…åˆä½¿ç”¨å‡½æ•°ä¸­çš„`call`æ–¹æ³•ã€‚

```javascript
Object.prototype.toString.call([])			// "[object Array]"
```

### 4. å®æˆ˜

#### 4.1 å­—ç¬¦ä¸²`+`å…¶ä»–åŸå§‹ç±»å‹

å­—ç¬¦ä¸²åœ¨åŠ å·è¿ç®—æœ‰æœ€é«˜çš„ä¼˜å…ˆçº§ï¼Œä¸å­—ç¬¦ä¸²ç›¸åŠ å¿…å®šæ˜¯å­—ç¬¦ä¸²è¿æ¥è¿ç®—ã€‚

```javascript
'1' + 123             // "1123"
'1' + false           // "1false"
'1' + null            // "1null"
'1' + undefined       // "1undefined"
'1' + {}              // "1[object Object]"
'1' + []              // "1"
'1' + 'NaN'           // 1NaN
```

#### 4.2 æ•°å­—`+`å…¶ä»–çš„éå­—ç¬¦ä¸²çš„åŸå§‹æ•°æ®ç±»å‹

æ•°å­—ä¸å…¶ä»–ç±»å‹ä½œç›¸åŠ æ—¶ï¼Œé™¤äº†å­—ç¬¦ä¸²ä¼šä¼˜å…ˆä½¿ç”¨å­—ç¬¦ä¸²è¿æ¥è¿ç®—`(concatenation)`çš„ï¼Œå…¶ä»–éƒ½è¦ä¾ç…§æ•°å­—ä¸ºä¼˜å…ˆï¼Œæ‰€ä»¥é™¤äº†å­—ç¬¦ä¸²ä¹‹å¤–çš„å…¶ä»–åŸå§‹æ•°æ®ç±»å‹ï¼Œéƒ½è¦è½¬æ¢ä¸ºæ•°å­—æ¥è¿›è¡Œæ•°å­¦çš„ç›¸åŠ è¿ç®—ã€‚

```javascript
1 + true            // 2
1 + null            // 1
1 + undefined       // NaN
1 + {}              // "1undefined"
1 + []              // "1"
```

#### 4.3 æ•°å­—/å­—ç¬¦ä¸²ä»¥å¤–çš„åŸå§‹æ•°æ®ç±»å‹ä½œåŠ æ³•è¿ç®—

å½“æ•°å­—ä¸å­—ç¬¦ä¸²ä»¥å¤–çš„ï¼Œå…¶ä»–åŸå§‹æ•°æ®ç±»å‹ç›´æ¥ä½¿ç”¨åŠ å·è¿ç®—æ—¶ï¼Œå°±æ˜¯è½¬ä¸ºæ•°å­—å†è¿ç®—ï¼Œè¿™ä¸å­—ç¬¦ä¸²å®Œå…¨æ— å…³ã€‚

```javascript
true + true         // 2
true + null         // 1
undefined + null    // NaN
```

#### 4.4 ç©ºæ•°ç»„ä¸ç©ºå¯¹è±¡

1.  `[] + []`

```javascript
[] + []			// ""
```

ä¸¤ä¸ªæ•°ç»„ç›¸åŠ ï¼Œä¾ç„¶æŒ‰ç…§`valueOf -> toString`çš„é¡ºåºï¼Œä½†å› ä¸º`valueOf`æ˜¯æ•°ç»„æœ¬èº«ï¼Œæ‰€ä»¥ä¼šä»¥`toString`çš„è¿”å›å€¼æ‰æ˜¯åŸå§‹æ•°æ®ç±»å‹ï¼Œä¹Ÿå°±æ˜¯ç©ºå­—ç¬¦ä¸²ï¼Œæ‰€ä»¥è¿™ä¸ªè¿ç®—ç›¸å½“äºä¸¤ä¸ªç©ºå­—ç¬¦ä¸²åœ¨ç›¸åŠ ï¼Œä¾ç…§åŠ æ³•è¿ç®—è§„åˆ™ç¬¬2æ­¥éª¤ï¼Œæ˜¯å­—ç¬¦ä¸²è¿æ¥è¿ç®—(concatenation)ï¼Œä¸¤ä¸ªç©ºå­—ç¬¦ä¸²è¿æ¥æœ€åå¾—å‡ºä¸€ä¸ªç©ºå­—ç¬¦ä¸²ã€‚

2.  `{} + {}`

```javascript
{} + {}			// "[object Object][object Object]"
```

ä¸¤ä¸ªç©ºå¯¹è±¡ç›¸åŠ ï¼Œä¾ç„¶æŒ‰ç…§`valueOf -> toString`çš„é¡ºåºï¼Œä½†å› ä¸º`valueOf`æ˜¯å¯¹è±¡æœ¬èº«ï¼Œæ‰€ä»¥ä¼šä»¥`toString`çš„è¿”å›å€¼æ‰æ˜¯åŸå§‹æ•°æ®ç±»å‹ï¼Œä¹Ÿå°±æ˜¯"[object Object]"å­—ç¬¦ä¸²ï¼Œæ‰€ä»¥è¿™ä¸ªè¿ç®—ç›¸å½“äºä¸¤ä¸ª"[object Object]"å­—ç¬¦ä¸²åœ¨ç›¸åŠ ï¼Œä¾ç…§åŠ æ³•è¿ç®—è§„åˆ™ç¬¬2æ­¥éª¤ï¼Œæ˜¯å­—ç¬¦ä¸²è¿æ¥è¿ç®—(concatenation)ï¼Œæœ€åå¾—å‡ºä¸€ä¸ª"object Object"å­—ç¬¦ä¸²ã€‚

ä½†æ˜¯è¿™ä¸ªç»“æœæœ‰å¼‚å¸¸ï¼Œä¸Šé¢çš„ç»“æœåªæ˜¯åœ¨Chromeæµè§ˆå™¨ä¸Šçš„ç»“æœ(v55)ï¼Œæ€ä¹ˆè¯´å‘¢ï¼Ÿ

æœ‰äº›æµè§ˆå™¨ä¾‹å¦‚`Firefox`ã€`Edge`æµè§ˆå™¨ä¼šæŠŠ`{} + {}`ç›´è¯‘ä¸ºç›¸å½“äº`+{}`è¯­å¥ï¼Œå› ä¸ºå®ƒä»¬ä¼šè®¤ä¸ºä»¥èŠ±æ‹¬å·å¼€å¤´(`{`)çš„ï¼Œæ˜¯ä¸€ä¸ªåŒºå—è¯­å¥çš„å¼€å¤´ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªå¯¹è±¡å­—é¢é‡ï¼Œæ‰€ä»¥ä¼šè®¤ä¸ºç•¥è¿‡ç¬¬ä¸€ä¸ª`{}`ï¼ŒæŠŠæ•´ä¸ªè¯­å¥è®¤ä¸ºæ˜¯ä¸ª`+{}`çš„è¯­å¥ï¼Œä¹Ÿå°±æ˜¯ç›¸å½“äºå¼ºåˆ¶æ±‚å‡ºæ•°å­—å€¼çš„`Number({})`å‡½æ•°è°ƒç”¨è¿ç®—ï¼Œç›¸å½“äº`Number("[object Object]")`è¿ç®—ï¼Œæœ€åå¾—å‡ºçš„æ˜¯`NaN`ã€‚

å¦‚æœåœ¨ç¬¬ä¸€ä¸ª(å‰é¢)çš„ç©ºå¯¹è±¡åŠ ä¸Šåœ†æ‹¬å·(`()`)ï¼Œè¿™æ ·JSå°±ä¼šè®¤ä¸ºå‰é¢æ˜¯ä¸ªå¯¹è±¡ï¼Œå°±å¯ä»¥å¾—å‡ºåŒæ ·çš„ç»“æœ:

```javascript
({}) + {}			// "[object Object][object Object]"
```

3.  `{} + []`

```javascript
{} + []			// 0
```

ä¸Šé¢åŒæ ·çš„æŠŠ`{}`å½“ä½œåŒºå—è¯­å¥çš„æƒ…å†µåˆä¼šå‘ç”Ÿï¼Œä¸è¿‡è¿™æ¬¡æ‰€æœ‰çš„æµè§ˆå™¨éƒ½ä¼šæœ‰ä¸€è‡´ç»“æœï¼Œå¦‚æœ`{}`(ç©ºå¯¹è±¡)åœ¨å‰é¢ï¼Œè€Œ`[]`(ç©ºæ•°ç»„)åœ¨åé¢æ—¶ï¼Œå‰é¢(å·¦è¾¹)é‚£ä¸ªè¿ç®—å…ƒä¼šè¢«è®¤ä¸ºæ˜¯åŒºå—è¯­å¥è€Œä¸æ˜¯å¯¹è±¡å­—é¢é‡ã€‚

æ‰€ä»¥`{} + []`ç›¸å½“äº`+[]`è¯­å¥ï¼Œä¹Ÿå°±æ˜¯ç›¸å½“äºå¼ºåˆ¶æ±‚å‡ºæ•°å­—å€¼çš„`Number([])`è¿ç®—ï¼Œç›¸å½“äº`Number("")`è¿ç®—ï¼Œæœ€åå¾—å‡ºçš„æ˜¯`0`æ•°å­—ã€‚

ç‰¹åˆ«æ³¨æ„: æ‰€ä»¥å¦‚æœç¬¬ä¸€ä¸ª(å‰é¢)æ˜¯`{}`æ—¶ï¼Œåé¢åŠ ä¸Šå…¶ä»–çš„åƒæ•°ç»„ã€æ•°å­—æˆ–å­—ç¬¦ä¸²ï¼Œè¿™æ—¶å€™åŠ å·è¿ç®—ä¼šç›´æ¥å˜ä¸ºä¸€å…ƒæ­£å·è¿ç®—ï¼Œä¹Ÿå°±æ˜¯å¼ºåˆ¶è½¬ä¸ºæ•°å­—çš„è¿ç®—ã€‚è¿™æ˜¯ä¸ªé™·é˜±è¦å°å¿ƒã€‚

4.  `[] + {}`

```javascript
[] + {}			// "[object Object]"
```

`[]`è½¬ä¸º`â€œâ€`ï¼Œ`{}`è½¬ä¸º`â€œ[object Object]â€`
